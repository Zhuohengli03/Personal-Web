---
import BaseLayout from '../layouts/BaseLayout.astro';
import fs from 'fs';
import path from 'path';

// Check if resume.pdf exists
const resumePath = '/resume.pdf';
const resumeExists = fs.existsSync(path.join(process.cwd(), 'public', 'resume.pdf'));
---
<BaseLayout title="æŽå“è¡¡ | ç®€åŽ†" description="Zhuoheng Li â€” Resume (PDF) download and view.">
  <h1 data-i18n="navResume">ç®€åŽ†</h1>
  
  {resumeExists ? (
    <>
      <p class="intro">
        <a href={resumePath} download><span class="content-zh">ä¸‹è½½ PDF</span><span class="content-en">Download PDF</span></a>
        <span class="content-zh"> Â· ä¸‹æ–¹é¢„è§ˆæˆ–æ–°æ ‡ç­¾æ‰“å¼€</span>
        <span class="content-en"> Â· View below or open in a new tab</span>
      </p>
      <div class="embed-wrap">
        <iframe
          title="Resume (PDF)"
          src={`${resumePath}#view=FitH`}
          class="pdf-embed"
          width="100%"
          height="720"
        />
      </div>
      <p class="fallback">
        <span class="content-zh">è‹¥æ— æ³•åŠ è½½ï¼Œè¯·</span><span class="content-en">If the PDF doesn't load, </span>
        <a href={resumePath} target="_blank" rel="noopener"><span class="content-zh">åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€</span><span class="content-en">open it in a new tab</span></a><span class="content-zh">ã€‚</span><span class="content-en">.</span>
      </p>
    </>
  ) : (
    <div class="no-resume">
      <div class="placeholder-icon">ðŸ“„</div>
      <p class="content-zh">ç®€åŽ† PDF å°šæœªä¸Šä¼ </p>
      <p class="content-en">Resume PDF has not been uploaded yet</p>
      <p class="hint content-zh">è¯·å°† PDF æ–‡ä»¶æ”¾åˆ° <code>public/resume.pdf</code></p>
      <p class="hint content-en">Please place your PDF at <code>public/resume.pdf</code></p>
    </div>
  )}
</BaseLayout>

<style>
  h1 {
    font-size: 1.5rem;
    font-weight: 700;
    margin: 0 0 0.5rem;
  }
  .intro {
    color: var(--muted);
    margin: 0 0 1rem;
    font-size: 0.95rem;
  }
  .embed-wrap {
    border: 1px solid var(--glass-border);
    border-radius: 8px;
    overflow: visible;
    background: var(--glass-bg);
    backdrop-filter: blur(var(--glass-blur));
    -webkit-backdrop-filter: blur(var(--glass-blur));
    box-shadow: var(--glass-shadow);
    width: 100%;
    max-width: 100%;
  }
  .pdf-embed {
    display: block;
    border: none;
    width: 100%;
    min-height: 720px;
    background: #fff;
    border-radius: 8px;
  }
  .fallback {
    margin: 1rem 0 0;
    font-size: 0.9rem;
    color: var(--muted);
  }
  .no-resume {
    text-align: center;
    padding: 4rem 2rem;
    background: var(--glass-bg);
    backdrop-filter: blur(var(--glass-blur));
    -webkit-backdrop-filter: blur(var(--glass-blur));
    border: 1px solid var(--glass-border);
    border-radius: 12px;
    box-shadow: var(--glass-shadow);
  }
  .placeholder-icon {
    font-size: 4rem;
    margin-bottom: 1rem;
    opacity: 0.6;
  }
  .no-resume p {
    margin: 0.5rem 0;
    font-size: 1.1rem;
  }
  .no-resume .hint {
    margin-top: 1.5rem;
    font-size: 0.9rem;
    color: var(--muted);
  }
  .no-resume code {
    background: rgba(255,255,255,0.15);
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    font-family: monospace;
  }
</style>
