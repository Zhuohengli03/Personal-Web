---
import BaseLayout from '../../layouts/BaseLayout.astro';
import MomentsPost from '../../components/magic/MomentsPost.astro';
import fs from 'fs';
import path from 'path';

const base = import.meta.env.BASE_URL;
const img = (name: string) => `${base}education/xian/${name}`;

const imageExtensions = new Set(['.jpg', '.jpeg', '.png', '.webp', '.gif']);
const dir = path.join(process.cwd(), 'public', 'education', 'xian');
let imageFiles: string[] = [];
try {
  const files = fs.readdirSync(dir);
  imageFiles = files
    .filter((f) => imageExtensions.has(path.extname(f).toLowerCase()) && !f.startsWith('.'))
    .sort();
} catch {
  // 目录不存在或无法读取
}
---
<BaseLayout title="西安音乐学院 | 李卓衡" description="Xi'an Conservatory of Music - Music Performance" contentClass="xian-detail">
  <div class="xian-page">
    <p class="xian-back"><a href={base}>← <span data-i18n="navHome">首页</span></a></p>

    <div class="xian-columns">
      <!-- 中列：古琴简介（静态） -->
      <section class="xian-intro-card detail-card" aria-label="Guqin introduction">
        <header class="xian-intro-header">
          <h2 class="xian-intro-title">
            <span class="content-zh">西安音乐学院</span>
            <span class="content-en">Xi'an Conservatory of Music</span>
          </h2>
          <p class="xian-intro-subtitle">
            <span class="content-zh">音乐表演学士（古琴）· 2021.09 – 2025.07</span>
            <span class="content-en">B.M. in Music Performance (Guqin) · 2021.09 – 2025.07</span>
          </p>
          <h3 class="xian-intro-label" data-i18n="xianGuqinIntro">古琴简介</h3>
        </header>
        <div class="xian-intro-body">
          <div class="content-zh">
            <p>古琴起源极早，一般认为其雏形可追溯至先秦时期，在战国至汉代逐渐定型，距今已有三千年以上历史。作为中国最古老、延续时间最长的弦乐器之一，古琴自古被视为“士人之器”，不仅是一种音乐工具，也承载着中国传统审美、修养与精神追求。</p>
            <p>古琴的标准形制为七弦、十三徽。七弦构成了古琴宽广而内敛的音域结构，不同定弦法（如正调、慢角、蕤宾等）会直接影响乐曲的色彩与情绪走向，使同一首作品在不同调式下呈现出截然不同的气质。琴面上镶嵌的十三徽，并非固定音高的“音键”，而是用来标示泛音与按音位置的参考点，是演奏者在指法与音高控制中的重要“坐标系统”。</p>
            <p>古琴的声音体系通常分为三类：<strong>散音</strong>——空弦音，音色浑厚而稳定，体现根基与空间感；<strong>泛音</strong>——轻触弦面在徽位附近发声，音色清亮、通透，如光影般点缀旋律；<strong>按音</strong>——左手按弦取音并配合滑动，是古琴最具表现力的音类。在按音演奏中，大量使用吟、猱、绰、注等细腻指法，使音高在连续变化中呈现出接近“语气”的效果。这种带有滑动与呼吸感的音型，是古琴音乐最重要的审美特征之一，也使其旋律更接近内心独白，而非外放的舞台表达。</p>
            <p>古琴在长期的发展过程中形成了不同地区与传承体系的流派风格。各地流派在速度处理、节奏呼吸、装饰音使用以及音色取向上皆有所侧重。有的流派强调含蓄内敛与气韵流动，有的注重线条清晰与结构感，也有流派更强调音乐叙事与层次推进。因此，同一首传统曲目，在不同流派的演绎下，往往呈现出截然不同的艺术风貌。</p>
            <p>在器物形制上，古琴发展出多种具有代表性的琴式，如仲尼式、伏羲式、蕉叶式、落霞式等。不同琴式在整体比例、边线走势、岳山与龙龈的结构处理上各有讲究，体现了不同时代与审美取向对“琴形”与“气度”的理解。传统古琴的斫制通常采用上面板与底板不同木材的结构，并通过复杂的灰胎与漆层工艺完成琴体。演奏者往往以“松、透、沉、润”等词汇来形容一张好琴的音色层次与响应状态。</p>
            <p>总体而言，古琴以其七弦十三徽的独特结构、丰富而内省的声音体系，以及因地域与师承而形成的多样流派风格，构成了一套高度成熟而细腻的音乐文化体系，也成为中国传统音乐中最具象征意义的器乐之一。</p>
          </div>
          <div class="content-en">
            <p>The guqin (古琴) is one of China’s oldest string instruments, with origins traceable to pre-Qin times and a standard form emerging by the Warring States to Han period—over three thousand years of history. Traditionally regarded as the “instrument of the literati,” it carries not only musical function but also Chinese aesthetic, cultivation, and spiritual ideals.</p>
            <p>Its standard form uses <strong>seven strings</strong> and <strong>thirteen hui</strong> (markers). The seven strings define a wide yet inward-focused range; different tunings (e.g. zhengdiao, manjue, Ruibin) shape the colour and mood of pieces. The thirteen hui are reference points for harmonics and stopped notes rather than fixed pitches—a “coordinate system” for fingering and intonation.</p>
            <p>Sound is often described in three types: <strong>open-string (散音)</strong>—solid and stable; <strong>harmonics (泛音)</strong>—clear and luminous; <strong>stopped/sliding notes (按音)</strong>—the most expressive, with techniques such as yin, nao, chuo, and zhu giving a speech-like, breathing quality that is central to guqin aesthetics.</p>
            <p>Regional and lineage traditions have given rise to distinct schools, differing in tempo, rhythm, ornamentation, and tone. Instrument shapes (e.g. Zhongni, Fuxi, Jiaoye, Luoxia) and construction—different woods for top and back, lacquer and filler—further define each instrument’s character. A fine qin is often described as “松、透、沉、润” (loose, transparent, deep, moist). Together, the qin’s structure, sound world, and diverse traditions form one of the most symbolic and refined systems in Chinese traditional music.</p>
          </div>
        </div>
      </section>

      <!-- 右列：朋友圈动态（图片/动态） -->
      <aside class="xian-moments-col" aria-label="Moments feed">
        <MomentsPost
          titleZh="动态"
          titleEn="Moments"
          subtitleZh=""
          subtitleEn=""
        >
          <div slot="images">
            {imageFiles.map((filename) => (
              <img src={img(filename)} alt="" />
            ))}
          </div>
        </MomentsPost>
      </aside>
    </div>

    <p class="xian-footer"><a href={base}>← <span data-i18n="navHome">首页</span></a></p>
  </div>
</BaseLayout>

<style>
  .xian-page {
    max-width: 100%;
  }
  .xian-back {
    font-size: 0.9rem;
    color: var(--muted);
    margin: 0 0 1rem;
  }
  .xian-back a { color: var(--accent); }
  .xian-columns {
    display: grid;
    grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
    gap: 1.5rem;
    align-items: start;
  }
  .detail-card {
    background: var(--glass-bg);
    backdrop-filter: blur(var(--glass-blur));
    -webkit-backdrop-filter: blur(var(--glass-blur));
    border: 1px solid var(--glass-border);
    border-radius: 12px;
    padding: 1rem 1.25rem;
    box-shadow: var(--glass-shadow);
  }
  .xian-intro-header {
    margin-bottom: 1rem;
  }
  .xian-intro-title {
    font-family: var(--font-serif);
    font-size: 1.1rem;
    font-weight: 600;
    margin: 0 0 0.2rem;
    color: var(--text);
  }
  .xian-intro-subtitle {
    font-size: 0.8rem;
    color: var(--muted);
    margin: 0 0 0.75rem;
  }
  .xian-intro-label {
    font-size: 0.95rem;
    font-weight: 600;
    color: var(--muted);
    margin: 0;
  }
  .xian-intro-body {
    font-size: 0.95rem;
    color: var(--text);
    line-height: 1.65;
  }
  .xian-intro-body :global(p) {
    margin: 0 0 0.75em;
  }
  .xian-intro-body :global(p:last-child) {
    margin-bottom: 0;
  }
  .xian-moments-col {
    min-width: 0;
  }
  .xian-footer {
    margin-top: 2rem;
    font-size: 0.9rem;
    color: var(--muted);
  }
  @media (max-width: 900px) {
    .xian-columns {
      grid-template-columns: 1fr;
    }
  }
</style>
