---
import BaseLayout from '../../layouts/BaseLayout.astro';
import MomentsPost from '../../components/magic/MomentsPost.astro';
import fs from 'fs';
import path from 'path';

const base = import.meta.env.BASE_URL;
const img = (name: string) => `${base}education/xian/${name}`;

const imageExtensions = new Set(['.jpg', '.jpeg', '.png', '.webp', '.gif']);
const dir = path.join(process.cwd(), 'public', 'education', 'xian');
let imageFiles: string[] = [];
try {
  const files = fs.readdirSync(dir);
  imageFiles = files
    .filter((f) => imageExtensions.has(path.extname(f).toLowerCase()) && !f.startsWith('.'))
    .sort();
} catch {
  // 目录不存在或无法读取
}
---
<BaseLayout title="西安音乐学院 | 李卓衡" description="Xi'an Conservatory of Music - Music Performance">
  <div class="edu-feed">
    <p class="feed-back"><a href={base}>← <span data-i18n="navHome">首页</span></a></p>

    <MomentsPost
      titleZh="西安音乐学院"
      titleEn="Xi'an Conservatory of Music"
      subtitleZh="音乐表演学士（古琴）· 2021.09 – 2025.07"
      subtitleEn="B.M. in Music Performance (Guqin) · 2021.09 – 2025.07"
    >
      <div class="content-zh">
        <p>此处可添加西安音乐学院相关照片与文字。可增加多段：复制下面一行再改内容。</p>
        <p>第二段示例：如古琴专业学习、演出与比赛、校园与志愿等。</p>
      </div>
      <div class="content-en">
        <p>Add photos and text about Xi'an Conservatory here. Add more paragraphs by copying a line below.</p>
        <p>Second paragraph example: e.g. Guqin studies, performances and competitions, campus and volunteering.</p>
      </div>
      <!-- 图片：把图片放到 public/education/xian/ 即可，构建时自动扫描并按文件名排序展示 -->
      <div slot="images">
        {imageFiles.map((filename) => (
          <img src={img(filename)} alt="" />
        ))}
      </div>
    </MomentsPost>
  </div>

  <p class="page-footer"><a href={base}>← <span data-i18n="navHome">首页</span></a></p>
</BaseLayout>

<style>
  .edu-feed {
    max-width: 520px;
    margin: 0 auto;
  }
  .feed-back {
    font-size: 0.9rem;
    color: var(--muted);
    margin: 0 0 1rem;
  }
  .feed-back a { color: var(--accent); }
  .page-footer { margin-top: 2rem; font-size: 0.9rem; color: var(--muted); }
</style>
