---
import BaseLayout from '../../layouts/BaseLayout.astro';
import MomentsPost from '../../components/magic/MomentsPost.astro';
import fs from 'fs';
import path from 'path';

const base = import.meta.env.BASE_URL;
const img = (name: string) => `${base}education/nyu/${name}`;

const imageExtensions = new Set(['.jpg', '.jpeg', '.png', '.webp', '.gif']);
const dir = path.join(process.cwd(), 'public', 'education', 'nyu');
let imageFiles: string[] = [];
try {
  const files = fs.readdirSync(dir);
  imageFiles = files
    .filter((f) => imageExtensions.has(path.extname(f).toLowerCase()) && !f.startsWith('.'))
    .sort();
} catch {
  // 目录不存在或无法读取
}
---
<BaseLayout title="纽约大学 | 李卓衡" description="NYU - Master of Management & Analytics">
  <div class="nyu-page">
    <p class="nyu-back"><a href="#" role="button" data-back>← <span data-i18n="navBack">返回上一页</span></a></p>

    <header class="nyu-hero">
      <h1 class="nyu-hero-title">
        <span class="content-zh">纽约大学</span>
        <span class="content-en">New York University</span>
      </h1>
      <p class="nyu-hero-subtitle">
        <span class="content-zh">管理与管理分析硕士（商业分析）· 2025.09 – 2026.12（预计）· GPA 3.83/4.00</span>
        <span class="content-en">M.S. in Management & Analytics (Business Analytics) · 2025.09 – 2026.12 (Expected) · GPA 3.83/4.00</span>
      </p>
    </header>

    <section class="nyu-moments-col" aria-label="Moments feed">
      <MomentsPost titleZh="动态" titleEn="Moments" subtitleZh="" subtitleEn="">
        <div slot="images">
          {imageFiles.map((filename) => (
            <img src={img(filename)} alt="" loading="lazy" />
          ))}
        </div>
      </MomentsPost>
    </section>

    <p class="nyu-footer"><a href="#" role="button" data-back>← <span data-i18n="navBack">返回上一页</span></a></p>
  </div>
</BaseLayout>

<style>
  .nyu-page {
    max-width: 100%;
  }
  .nyu-back {
    font-size: 0.9rem;
    color: var(--muted);
    margin: 0 0 1rem;
  }
  .nyu-back a {
    color: var(--accent);
  }

  .nyu-hero {
    text-align: center;
    margin-bottom: 1.5rem;
  }
  .nyu-hero-title {
    font-family: "Dancing Script", "ZCOOL XiaoWei", "Noto Serif SC", cursive;
    font-size: clamp(1.75rem, 5vw, 2.5rem);
    font-weight: 700;
    margin: 0 0 0.35rem;
    color: var(--text);
    letter-spacing: 0.02em;
  }
  .nyu-hero-subtitle {
    font-size: 0.9rem;
    color: var(--muted);
    margin: 0;
  }

  .nyu-moments-col {
    min-width: 0;
  }
  .nyu-footer {
    margin-top: 2rem;
    font-size: 0.9rem;
    color: var(--muted);
  }
</style>
