---
import BaseLayout from '../../layouts/BaseLayout.astro';
import BorderBeam from '../../components/magic/BorderBeam.astro';
import ProjectCard from '../../components/ProjectCard.astro';
import { getCollection } from 'astro:content';
import { hardcodedProjects } from '../../data/hardcodedProjects';
const base = import.meta.env.BASE_URL;
const fromMarkdown = await getCollection('projects');
const sorted = [...fromMarkdown].sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---
<BaseLayout title="项目 | 李卓衡" description="Data and analytics projects">
  <h1 class="page-title" data-i18n="sectionProjects">项目</h1>

  <div class="project-grid">
    {hardcodedProjects.map((project) => (
      <BorderBeam class="project-card-wrap">
        <a class="project-card-link" href={`${base}projects/${project.slug}/`}>
          <article class="project-card">
            <h2 class="project-title content-zh">{project.titleZh}</h2>
            <h2 class="project-title content-en">{project.titleEn}</h2>
            <div class="content-zh"><p set:html={project.descriptionZh.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')} /></div>
            <div class="content-en"><p set:html={project.descriptionEn.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')} /></div>
          </article>
        </a>
      </BorderBeam>
    ))}
  </div>

  {sorted.length > 0 && (
    <section class="markdown-projects">
      <h2 class="subsection-title content-zh" data-i18n="projectsMoreMarkdown">更多（Markdown）</h2>
      <h2 class="subsection-title content-en" data-i18n="projectsMoreMarkdown">More (from Markdown)</h2>
      <div class="project-grid markdown-grid">
        {sorted.map((entry) => (
          <ProjectCard entry={entry} />
        ))}
      </div>
    </section>
  )}

  <p class="page-footer"><a href={base}>← <span data-i18n="navHome">首页</span></a></p>
</BaseLayout>

<style>
  .page-title { font-family: var(--font-serif); font-size: 1.5rem; font-weight: 600; margin: 0 0 1.5rem; }
  .project-grid { display: grid; gap: 1.25rem; }
  .project-card-wrap {
    border-radius: var(--radius);
    padding: 2px;
    background: var(--glass-bg);
    backdrop-filter: blur(var(--glass-blur));
    -webkit-backdrop-filter: blur(var(--glass-blur));
    border: 1px solid var(--glass-border);
    box-shadow: var(--glass-shadow);
  }
  .project-card-link {
    display: block;
    text-decoration: none;
    color: inherit;
  }
  .project-card-link:hover {
    color: inherit;
  }
  .project-card {
    background: rgba(22, 27, 34, 0.2);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    border: 1px solid var(--glass-border);
    border-radius: calc(var(--radius) - 2px);
    padding: 1.25rem;
    position: relative;
    z-index: 0;
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.05);
  }
  .project-title { font-family: var(--font-serif); font-size: 1.1rem; font-weight: 600; margin: 0 0 0.5rem; }
  .project-card .content-zh p, .project-card .content-en p { margin: 0; font-size: 0.9rem; color: var(--muted); line-height: 1.6; }
  .markdown-projects { margin-top: 2.5rem; padding-top: 1.5rem; border-top: 1px solid var(--glass-border); }
  .subsection-title { font-size: 1.1rem; font-weight: 600; margin: 0 0 1rem; }
  .page-footer { margin-top: 2rem; font-size: 0.9rem; color: var(--muted); }
</style>
